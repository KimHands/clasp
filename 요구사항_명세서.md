# 요구사항 명세서
## 파일 정리 및 시각화 도구

---

## 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [기능 요구사항](#2-기능-요구사항)
3. [비기능 요구사항](#3-비기능-요구사항)
4. [제약 사항](#4-제약-사항)

---

## 1. 프로젝트 개요

### 1.1 목적

본 문서는 '파일 정리 및 시각화 도구'의 기능 및 비기능 요구사항을 정의한다. 개발팀은 본 명세를 기준으로 설계 및 구현을 진행하며, 바이브코딩(AI 코드 생성) 기반으로 개발된다.

### 1.2 프로젝트 범위

사용자가 사전에 설정한 기준으로 로컬 파일을 자동 분류하고, 분류 결과를 그래프 노드 형식으로 시각화하는 데스크톱 애플리케이션을 개발한다.

### 1.3 타겟 사용자

| 사용자 | 주요 사용 시나리오 |
|---|---|
| 대학생 | 과제 / 강의 자료 정리, 과목별 파일 묶음 파악 |
| 직장인 | 업무 문서 정리, 프로젝트별 파일 분류 |
| 개발자 | 기술 스택별 자료 정리, 폴더 계층 시각화 |

### 1.4 핵심 가치

- **프라이버시 우선**: 파일 원문을 외부 서버로 전송하지 않는 구조
- **유연한 분류**: 파일 내용 / 확장자 / 날짜 기준의 우선순위 설정 가능
- **직관적 시각화**: 태그 기반 클러스터 그래프로 파일 관계를 한눈에 파악
- **신뢰도 기반 투명성**: 분류 근거와 신뢰도를 사용자에게 명시적으로 표시

---

## 2. 기능 요구사항

### 2.1 Use Case 목록

| UC | 기능명 | 설명 |
|---|---|---|
| UC-01 | 폴더 선택 | 정리 대상 폴더를 지정한다 |
| UC-02 | 폴더 스캔 | 파일 목록 및 메타데이터 / 내용을 분석한다 |
| UC-03 | 분류 결과 확인 | 리스트 / 그래프 뷰로 결과를 확인한다 |
| UC-04 | 분류 수정 | 카테고리 / 태그를 수동으로 편집한다 |
| UC-05 | 규칙 관리 | 분류 규칙을 추가 / 수정 / 삭제 / 우선순위 설정한다 |
| UC-06 | 정리 적용 | 분류 결과에 따라 실제 파일을 이동한다 |
| UC-07 | 되돌리기 | 직전 정리 작업을 복구한다 (Undo) |

---

### 2.2 UC-01: 폴더 선택

**목표**: 정리 대상 폴더를 지정한다.

**기본 흐름**
1. 사용자가 '폴더 선택' 버튼 클릭
2. 시스템이 파일 탐색기를 열어 폴더 선택 UI 표시
3. 사용자가 대상 폴더 선택
4. 시스템이 선택된 경로를 화면에 표시하고 최근 작업 목록에 추가

**예외 흐름**
- E1. 사용자가 선택 취소 → 시스템은 이전 상태 유지

---

### 2.3 UC-02: 폴더 스캔

**목표**: 폴더 내 파일 목록 및 메타데이터 / 내용을 분석한다.

**기본 흐름**
1. 사용자가 '스캔 시작' 클릭
2. 시스템이 폴더 내 파일 목록을 재귀 탐색하여 수집
3. 시스템이 메타데이터(이름 / 확장자 / 날짜 / 크기) 분석 및 SQLite 즉시 저장 (체크포인트)
4. 텍스트 추출 가능 파일(pdf / docx / txt / md)에 대해 본문 4구간 샘플링 수행
5. 시스템이 표지 탐지 후 표지 텍스트 별도 추출 및 임베딩 저장
6. 파일 간 표지 유사도 계산 → 자동 태그 그룹 생성
7. 시스템이 분류 엔진(Tier 1 → 2 → 3) 실행 및 결과 저장
8. SSE를 통해 단계별 진행 상황을 프론트엔드에 실시간 전달

**본문 샘플링 구간**

| 구간 | 위치 | 목적 |
|---|---|---|
| 1구간 | 전체의 30% 지점 | 도입부 핵심 내용 |
| 2구간 | 전체의 45% 지점 | 전반부 본문 |
| 3구간 | 전체의 65% 지점 | 후반부 본문 |
| 4구간 | 전체의 85% 지점 | 결론 / 요약 |

> PDF 3페이지 이상인 경우 1~2페이지(표지/목차) 스킵 후 샘플링

**SSE 단계별 상태**

| 단계 | 상태 메시지 |
|---|---|
| 1 | 파일 목록 수집 중 |
| 2 | 메타데이터 분석 중 |
| 3 | 표지 탐지 중 |
| 4 | 본문 추출 중 |
| 5 | 분류 엔진 처리 중 |
| 6 | 유사도 계산 중 |
| 7 | 완료 |

**예외 흐름**
- E1. 파일 접근 권한 없음 → 오류 안내 및 해당 파일/폴더 제외 후 계속 진행
- E2. 지원하지 않는 형식 → 내용 분석 생략, 메타데이터 기반 Tier 1 처리

---

### 2.4 UC-03: 분류 결과 확인

**목표**: 자동 분류 결과를 UI로 확인한다.

**기본 흐름**
1. 시스템이 분류 결과를 리스트 뷰(테이블)로 표시
2. 시스템이 태그 그룹 기반 클러스터 그래프 뷰를 제공
3. 사용자가 카테고리 / 태그 / 신뢰도 기준으로 필터링 및 검색 가능
4. 신뢰도 낮은 파일은 색상으로 강조 표시
5. 미분류 파일(신뢰도 31% 미만)은 상단 배너 알림으로 표시

**그래프 뷰 레이아웃**

| 레이아웃 | 설명 | 기본값 |
|---|---|---|
| 클러스터 버블 | 태그 그룹을 버블로 표현, 파일은 내부 노드 | ✅ 기본값 |
| 트리 | 폴더 계층 구조 확인용 | 선택 |
| 포스 다이렉티드 | 파일 간 유사도 연결선 확인용 | 선택 |

---

### 2.5 UC-04: 분류 수정 (수동 편집)

**목표**: 사용자가 일부 파일의 분류 / 태그를 수정한다.

**기본 흐름**
1. 사용자가 특정 파일 클릭 → 우측 슬라이드 패널 표시
2. 패널에서 분류 근거(사용된 Tier + 신뢰도 + 핵심 키워드) 확인 가능
3. 사용자가 카테고리 / 태그 수동 수정
4. 시스템이 수정 내용을 SQLite에 저장 (is_manual = true)
5. 시스템이 리스트 / 그래프 뷰 실시간 갱신
6. 수동 분류 결과는 다음 스캔 시 Tier 1에서 우선 참조 (사용자 맞춤 학습)

**예외 흐름**
- E1. 저장 실패 → 오류 안내 및 변경 취소

---

### 2.6 UC-05: 규칙 관리

**목표**: 정리 규칙을 설정하고 재사용한다.

**기본 흐름**
1. 사용자가 '규칙 관리' 화면 진입
2. 사용자가 규칙 추가 / 수정 / 삭제 가능
3. 드래그 앤 드롭으로 우선순위(룰 순서) 조정
4. 시스템이 해당 우선순위로 정리된 폴더 구조를 실시간 미리보기로 표시
5. 시스템이 규칙을 SQLite에 저장

**우선순위 예시**
```
1순위: 파일 날짜 → 2순위: 파일 내용 → 3순위: 파일 확장자
결과 폴더 구조: 2025 → 보안 → PDF
```

**예외 흐름**
- E1. 규칙 충돌 / 형식 오류 → 검증 메시지 표시, 저장 불가

---

### 2.7 UC-06: 정리 적용

**목표**: 분류 결과에 따라 실제 파일을 정리한다.

**기본 흐름**
1. 사용자가 '정리 적용' 클릭
2. 시스템이 이동 / 정리 계획을 트리뷰로 미리 표시 (이동 파일 수, 생성 폴더 수 요약)
3. 사용자가 실행 확인
4. 시스템이 파일 이동 / 폴더 생성 수행
5. 시스템이 실행 결과와 로그(action_logs)를 SQLite에 저장
6. 미분류 파일(신뢰도 31% 미만)은 이동 대상에서 자동 제외

**예외 흐름**
- E1. 동일 파일명 충돌 → '덮어쓰기 / 이름변경 / 건너뛰기' 선택 UI 표시
- E2. 이동 실패(권한 / 잠금) → 실패 목록 표시, 나머지 파일 계속 진행

---

### 2.8 UC-07: 되돌리기 (Undo)

**목표**: 직전 정리 작업을 이전 상태로 복구한다.

**기본 흐름**
1. 사용자가 '되돌리기' 클릭
2. 시스템이 최근 action_logs를 불러와 역방향 파일 이동 수행
3. 시스템이 복구 결과를 표시하고 로그에 is_undone = true 저장

**예외 흐름**
- E1. 원본 경로 없음 / 파일 삭제됨 → 복구 불가 항목 별도 표시

---

## 3. 비기능 요구사항

| 분류 | 항목 | 기준 |
|---|---|---|
| 성능 | 스캔 속도 | 파일 100개 기준 60초 이내 분류 완료 |
| 성능 | 그래프 렌더링 | 파일 100개 이상에서 3초 이내 렌더링 |
| 보안 | 파일 원문 외부 전송 | Tier 3 사용 시에도 요약 텍스트만 전송, 원문 전송 금지 |
| 프라이버시 | 민감 파일 처리 | 사용자 지정 키워드 포함 파일은 내용 분석 제외 옵션 제공 |
| 호환성 | 지원 운영체제 | macOS arm64 / x64, Windows x64 |
| 호환성 | Python 설치 | 사용자 별도 Python 설치 불필요 (PyInstaller 번들) |
| 안정성 | Undo | 정리 적용 후 원상복구 보장 (복구 불가 항목은 명시) |
| 사용성 | 미분류 파일 | 신뢰도 31% 미만 파일은 이동 대상 자동 제외 및 사용자에게 명시 |
| 사용성 | 실시간 진행 | 스캔 진행 상황을 단계별로 실시간 표시 |
| 확장성 | LLM 제공자 | OpenAI 외 다른 클라우드 LLM 연동 가능한 구조 설계 |

---

## 4. 제약 사항

| 항목 | 내용 |
|---|---|
| HWP 지원 | 공개 파서 불안정으로 메타데이터 기반 처리만 지원, 내용 분류 불가 |
| 비텍스트 파일 | 이미지 / 영상 / exe 파일은 내용 분류 불가, 메타데이터(Tier 1)만 사용 |
| 대용량 폴더 | 파일 수천 개 이상 시 Tier 2 처리 속도 저하 가능성 있음 |
| 표지 탐지 | 정형화된 표지가 없는 파일은 탐지 누락 가능 |
| Local LLM | 하드웨어 제한으로 Local LLM 미지원, 경량 임베딩 모델(Tier 2)로 대체 |

---

*작성일: 2025년 02월*
